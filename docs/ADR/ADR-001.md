# Architecture Decision Records (ADR)
## Сервіс Підписки на Погоду

## ADR-001: Вибір багаторівневої архітектури

**Версія:** 1.01  
**Дата:** 09/06/2025  
**Автор:** Roman Ustymenko  

---


### Контекст

Необхідно визначити архітектурний підхід для веб-застосунку сервісу підписки на погоду. Система повинна забезпечувати чітке розділення відповідальності, легкість тестування та можливість майбутнього розвитку.

### Рішення

## Огляд архітектури

**Layered Architecture** з елементами **Clean Architecture**. Чіткий розподіл на шари з інверсією залежностей.

## Архітектурні шари

### - **Presentation Layer** (HTTP Interface)
**Файли:** `internal/api/handlers/`, `internal/api/router.go`
- HTTP контролери для weather та subscription endpoints
- Маршрутизація та валідація запитів


### - **Application Layer** (Business Logic)
**Файли:** `internal/app.go`, `internal/jobs/weather_notification.go`
- Координація бізнес-процесів
- Фонові завдання для погодних уведомлень
- Управління життєвим циклом підписок

### - **Infrastructure Layer** (External Services)

#### **Database Module**
**Файли:** `internal/db/`, `migrations/`
- Репозиторій для роботи з даними
- Міграції PostgreSQL

#### **Email Service Module**
**Файли:** `internal/mailer/`, `internal/templates/`
- SMTP клієнт та HTML шаблони
- Mock реалізація для тестування

#### **Weather API Module**
**Файли:** `internal/openweatherapi/fetch.go`
- HTTP клієнт для OpenWeatherMap API
- Трансформація зовнішніх даних

### - **Configuration Layer**
**Файли:** `internal/config/config.go`
- Централізоване управління налаштуваннями
- Змінні оточення



### Обґрунтування

**Переваги:**
- Чітке розділення відповідальності між компонентами
- Легкість тестування кожного шару окремо  
- Можливість незалежної розробки різних шарів
- Спрощення масштабування та підтримки
- Стандартизований підхід, зрозумілий команді

**Недоліки:**
- Додаткова складність порівняно з монолітом
- Потенційні проблеми з продуктивністю через міжрівневі виклики

**Альтернативи:**
- **Монолітна архітектура:** Простіша у розробці, але менш гнучка
- **Мікросервісна архітектура:** Надмірна складність для розміру проекту
- **Hexagonal Architecture:** додає багато абстракцій для простих операцій
- **DDD Architecture:** більше коду, менш гнучка до зміни вимог

### Наслідки

- Структура проекту буде організована за шарами
- Кожен шар матиме чіткі API для взаємодії
- Тестування виконується на рівні кожного шару
- Розгортання залишається простим (один застосунок)
---